document.getElementById("body").style.height=window.innerHeight+"px";document.getElementById("body").style.width=window.innerWidth-20+"px";$("#shangyibu").linkbutton({text:"上一步",iconCls:"icon-undo",iconAlign:"left",});$("#xiayibu").linkbutton({text:"下一步",iconCls:"icon-redo",iconAlign:"left",});$("#huanyuan").linkbutton({text:"还原",iconCls:"icon-reload",iconAlign:"left",});$("#save").linkbutton({text:"保存到数据库",iconCls:"icon-save",iconAlign:"left",});$("#savelocal").linkbutton({text:"保存到本地",iconCls:"icon-save",iconAlign:"left",});$("#shanchu").linkbutton({text:"删除",iconCls:"icon-no",iconAlign:"left",});$("#qingkong").linkbutton({text:"清空",iconCls:"icon-clear",iconAlign:"left",});$("#svgcombo").combogrid({panelWidth:770,idField:"id",textField:"id",value:"搜索或者查看私有量子电路作品",columns:[[{field:"id",title:"编号",width:120,},{field:"name",title:"作品名",width:120,},{field:"username",title:"作者",width:120,},{field:"imageurl",title:"预览效果",width:120,},{field:"time",title:"创建时间",width:120,},{field:"type",title:"权限管理",width:120,},]],onShowPanel:function(){},data:[{"id":1,"name":"蜡笔小新","username":"sdafads","imageurl":"fsdaf","time":"2014-10-1","type":1,},{"id":1,"name":"蜡笔小新","username":"sdafads","imageurl":"fsdaf","time":"2014-10-1","type":1,}],});$("#zuzuopin").combogrid({panelWidth:770,idField:"id",textField:"user",value:"组作品",columns:[[{field:"id",title:"编号",width:120,},{field:"name",title:"组名",width:120,},{field:"date",title:"组创建者",width:120,},{field:"email",title:"预览效果",width:120,},{field:"date",title:"创建时间",width:120,},{field:"type",title:"权限管理",width:120,},]],onShowPanel:function(){},});$("#all").combogrid({panelWidth:645,idField:"id",textField:"user",value:"搜索或者查看所有量子电路作品",columns:[[{field:"id",title:"编号",width:120,},{field:"name",title:"作品名",width:120,},{field:"date",title:"作者",width:120,},{field:"email",title:"预览效果",width:120,},{field:"date",title:"创建时间",width:120,},]],onShowPanel:function(){},});$("#gongju").window({title:"绘制工具",width:300,height:50,collapsible:true,minimizable:false,maximizable:false,closable:false,closed:false,zIndex:9999,draggable:true,resizable:false,shadow:false,inline:false,modal:false,});$("#gongju").window("move",{left:700,top:10,});var counttd=0;for(var x=0;x<16;x=x+3){for(var y=0;y<16;y=y+3){for(var z=0;z<16;z=z+3){tdarray[counttd].style.backgroundColor="#"+getcchar(x)+getcchar(x)+getcchar(y)+getcchar(y)+getcchar(z)+getcchar(z);counttd++}}}function getcchar(A){switch(A){case 12:return"C";break;case 15:return"F";break;default:return A;break}}$("#propertydiv").propertygrid({width:270,height:"auto",showGroup:true,scrollbarSize:0,columns:[[{field:"name",title:"Name",width:120,resizable:true},{field:"value",title:"Value",width:100,resizable:true}]],onClickRow:function(B,A){console.log(A.name+A.value);switch(A.name){case"stroke":case"fill":case"background":colorwindow.style.display="block";colorwindow.style.left=currentleftshu-150+"px";colorwindow.style.top=currentrightshu+"px";propertyindex=B;propertyname=A.name;break;default:break}},onAfterEdit:function(L,T,G){var H;var J;var Q;var X;var Z=true;if(diantarget.tagName=="g"&&T.name=="符号序列"){var P=diantarget.childNodes;for(var g=0;g<P.length;){H=parseInt(P[0].getAttribute("x"));J=parseInt(P[0].getAttribute("y"));if(Z){Q=H;X=J;Z=false}else{if(Q>H){Q=H}if(X>J){X=J}}diantarget.removeChild(P[0])}Z=true;createfuhaozuByAttrGrid(T.value,diantarget,Q,X);return}if(diantarget.tagName=="g"&&T.name=="组合线数"){var P=diantarget.childNodes;for(var b=0;b<P.length;){H=parseInt(P[0].getAttribute("x1"));J=parseInt(P[0].getAttribute("y1"));if(Z){Q=H;X=J;Z=false}else{if(Q>H){Q=H}if(X>J){X=J}}diantarget.removeChild(P[0])}Z=true;createzuhelineByAttrGrid(parseInt(T.value),diantarget,Q,X);return}if(diantarget.tagName=="g"&&T.name=="受控点数"){var P=diantarget.childNodes;var e=0;var U;for(var g=0;g<P.length;){if(P[0].tagName=="circle"){H=parseInt(P[0].getAttribute("cx"));J=parseInt(P[0].getAttribute("cy"));if(Z){Q=H;X=J;U=P[0].getAttribute("class");Z=false}else{if(Q>H){Q=H}if(X>J){X=J;U=P[0].getAttribute("class")}}}if(P[0].getAttribute("class")=="shoucontrol"){e++}diantarget.removeChild(P[0])}Z=true;for(var N=0;N<e;N++){gggg.removeChild(gggg.childNodes[0])}var D;if(U=="shoucontrol"){D=0}else{D=1}createzuhedianByAttrGrid(parseInt(diantarget.getAttribute("kongzhidiancount")),parseInt(T.value),diantarget,Q,X,D);return}if(diantarget.tagName=="g"&&T.name=="控制点数"){var P=diantarget.childNodes;var e=0;var U;for(var g=0;g<P.length;){if(P[0].tagName=="circle"){H=parseInt(P[0].getAttribute("cx"));J=parseInt(P[0].getAttribute("cy"));if(Z){Q=H;X=J;U=P[0].getAttribute("class");Z=false}else{if(Q>H){Q=H}if(X>J){X=J;U=P[0].getAttribute("class")}}}if(P[0].getAttribute("class")=="shoucontrol"){e++}diantarget.removeChild(P[0])}Z=true;for(var N=0;N<e;N++){gggg.removeChild(gggg.childNodes[0])}var D;if(U=="shoucontrol"){D=0}else{D=1}createzuhedianByAttrGrid(parseInt(T.value),parseInt(diantarget.getAttribute("shoukongdiancount")),diantarget,Q,X,D);return}if(diantarget.tagName=="g"&&T.name=="zuhedianjianju"){var B=0;var S=$(svgg).children("g");var F=0;var a=0;var V=true;for(var i=0;i<S.length;i++){if(S[i].getAttribute("class")=="fuhaozu"){var R=parseInt(S[i].childNodes[0].getAttribute("x"));if(B<R){B=R}}if(S[i].getAttribute("class")=="zuhedian"){if(V){F=parseInt(S[i].childNodes[1].getAttribute("cx"));a=parseInt(S[i].childNodes[1].getAttribute("cx"));V=false}else{var A=parseInt(S[i].childNodes[1].getAttribute("cx"));if(F>A){F=A}if(A>a){a=A}}}}f=$(svgg).children("circle");for(var g=0;g<f.length;g++){var A=parseInt(f[g].getAttribute("cx"));if(F>A){F=A}if(A>a){a=A}}var f;var W=parseInt(T.value);var Y;for(var N=0;N<S.length;N++){switch(S[N].getAttribute("class")){case"zuhedian":Y=parseInt(S[N].getAttribute("zuhedianjianju"));S[N].setAttribute("zuhedianjianju",W);f=$(S[N]).children("circle");var C=$(S[N]).children("line")[0];var M;for(var g=0;g<f.length;g++){M=(f[g].getAttribute("cx")-F)/(Y*10)*W*10+F;f[g].setAttribute("cx",M)}C.setAttribute("x1",(C.getAttribute("x1")-F)/(Y*10)*W*10+F);C.setAttribute("x2",(C.getAttribute("x2")-F)/(Y*10)*W*10+F);var O=$(S[N]).children("rect")[0];O.setAttribute("x",(O.getAttribute("x")-F)/(Y*10)*W*10+F);break;case"fuhaozu":if(S[N].childNodes[0].getAttribute("x")==B){f=S[N].childNodes;for(var g=0;g<f.length;g++){f[g].setAttribute("x",(a-F)/(Y*10)*W*10+W*10+F)}}break;default:break}}f=$(svgg).children("circle");var h;for(var g=0;g<f.length;g++){h=(f[g].getAttribute("cx")-F)/(Y*10)*W*10+F;f[g].setAttribute("cx",h)}for(var i=0;i<S.length;i++){if(S[i].getAttribute("class")=="zuheline"){var I=S[i].childNodes;for(var g=0;g<I.length;g++){I[g].setAttribute("x2",(a-F)/(Y*10)*W*10+W*10/2+F)}}}tianjiaShiZi();jilubianhua();return}if(diantarget.tagName=="g"&&T.name=="zujianju"){if(diantarget.getAttribute("zujianjuall")!=null){var d;var S=$(svgg).children("g");for(var i=0;i<S.length;i++){if(S[i].getAttribute("class")=="zuheline"){d=parseInt(S[i].childNodes[0].getAttribute("y1"))}}var f;var W=parseInt(T.value);var Y;var E;for(var N=0;N<S.length;N++){switch(S[N].getAttribute("class")){case"zuheline":S[N].setAttribute("zujianjuall",W);f=S[N].childNodes;for(var g=1;g<f.length;g++){f[g].setAttribute("y1",parseInt(f[0].getAttribute("y1"))+W*10*g);f[g].setAttribute("y2",parseInt(f[0].getAttribute("y2"))+W*10*g)}break;case"zuhedian":S[N].setAttribute("zujianjuall",W);Y=parseInt(S[N].getAttribute("zujianju"));f=$(S[N]).children("circle");var C=$(S[N]).children("line")[0];var M;for(var g=0;g<f.length;g++){M=(f[g].getAttribute("cy")-d)/(Y*10)*W*10+d;f[g].setAttribute("cy",M)}C.setAttribute("y1",(C.getAttribute("y1")-d)/(Y*10)*W*10+d);C.setAttribute("y2",(C.getAttribute("y2")-d)/(Y*10)*W*10+d);var O=$(S[N]).children("rect")[0];O.setAttribute("y",(O.getAttribute("y")-d)/(Y*10)*W*10+d);O.setAttribute("height",(f.length-1)*W*10);break;case"fuhaozu":f=S[N].childNodes;for(var g=1;g<f.length;g++){f[g].setAttribute("y",parseInt(f[0].getAttribute("y"))+W*10*g)}break;default:break}S[N].setAttribute("zujianju",W)}f=$(svgg).children("circle");var h;for(var g=0;g<f.length;g++){h=(f[g].getAttribute("cy")-d)/(Y*10)*W*10+d;f[g].setAttribute("cy",h)}}else{var f;var W=parseInt(T.value);var E;switch(diantarget.getAttribute("class")){case"zuheline":f=diantarget.childNodes;for(var g=1;g<f.length;g++){f[g].setAttribute("y1",parseInt(f[0].getAttribute("y1"))+W*10*g);f[g].setAttribute("y2",parseInt(f[0].getAttribute("y2"))+W*10*g)}break;case"zuhedian":f=$(diantarget).children("circle");var C=$(diantarget).children("line")[0];var l;for(var g=0;g<f.length;g++){if(f[g].getAttribute("cy")==C.getAttribute("y1")){E=f[g].getAttribute("cy");l=g;break}}for(var g=0;g<f.length;g++){if(g!=l){f[g].setAttribute("cy",parseInt(E)+W*10*g)}}C.setAttribute("y2",parseInt(E)+W*10*(f.length-1));var O=$(diantarget).children("rect")[0];O.setAttribute("height",(f.length-1)*W*10);break;case"fuhaozu":f=diantarget.childNodes;for(var g=1;g<f.length;g++){f[g].setAttribute("y",parseInt(f[0].getAttribute("y"))+W*10*g)}break;default:break}diantarget.setAttribute("zujianju",W)}tianjiaShiZi();jilubianhua();return}if(diantarget.tagName=="g"&&T.name=="font-size"){var f=diantarget.childNodes;for(var g=0;g<f.length;g++){f[g].setAttribute(T.name,T.value)}jilubianhua();return}if(diantarget.tagName=="g"){console.log("lllllll");var f=diantarget.childNodes;for(var g=0;g<f.length;g++){if(f[g].tagName!="text"){f[g].setAttribute(T.name,T.value)}}jilubianhua();return}var c=T.name;if(c=="stroke-width"||c=="font-size"||c=="cx"||c=="cy"||c=="r"){if(diantarget.tagName=="svg"){var k=diantarget.childNodes;for(var g=0;g<k.length;g++){if(k[g].tagName!="g"){k[g].setAttribute("stroke-width",T.value)}}}else{var P=svgg.childNodes;var K=diantarget.getAttribute("class");for(var g=0;g<P.length;g++){if(P[g].getAttribute("class")==K){P[g].setAttribute(T.name,T.value)}}}tianjiaShiZi();jilubianhua()}},});var wanggewidthh=10;var wanggewidthv=10;function createwangge(A,G,C){var H=A.childNodes;for(var E=0;E<H.length;){if(H[E].tagName!="g"){A.removeChild(H[E]);continue}E++}var D=document.createElementNS(SVG_NS,"rect");D.setAttribute("x",0);D.setAttribute("y",0);D.setAttribute("width",G);D.setAttribute("height",C);D.setAttribute("stroke","gray");D.setAttribute("stroke-width","1");D.setAttribute("fill","none");A.appendChild(D);for(var F=0;F<C;F=F+wanggewidthh){var B=document.createElementNS(SVG_NS,"line");B.setAttribute("x1",0);B.setAttribute("y1",F);B.setAttribute("x2",G);B.setAttribute("y2",F);B.setAttribute("stroke","#F3F3F3");B.setAttribute("stroke-width","1");B.setAttribute("class","h");B.setAttribute("stroke-dasharray","0,0");A.appendChild(B)}for(var F=0;F<G;F=F+wanggewidthv){var B=document.createElementNS(SVG_NS,"line");B.setAttribute("x1",F);B.setAttribute("y1",0);B.setAttribute("x2",F);B.setAttribute("y2",C);B.setAttribute("stroke","#F3F3F3");B.setAttribute("stroke-width","1");B.setAttribute("class","h");B.setAttribute("stroke-dasharray","0,0");A.appendChild(B)}}function createSVG(){var B=document.getElementById("canvas");var A=document.createElementNS(SVG_NS,"svg");var C=B.getAttribute("width");var D=B.getAttribute("height");A.setAttribute("width",C.substr(0,C.length-2));A.setAttribute("height",D.substring(0,D.length-2));A.setAttribute("viewBox","0 0 2000 1500");A.setAttribute("xmlns","http://www.w3.org/2000/svg");A.setAttribute("background","#FFFFFF");A.setAttribute("class","svg");A.setAttribute("gridvisible","yes");createwangge(A,C.substr(0,C.length-2),D.substring(0,D.length-2));document.getElementById("canvas").appendChild(A);return A}svg=createSVG();var svgg=document.createElementNS(SVG_NS,"g");svgg.setAttribute("id","svgcontent");svg.appendChild(svgg);function huizhibilichi(){var D=document.getElementById("rulerhc");var C=D.getContext("2d");C.beginPath();C.clearRect(0,0,D.width,D.height);C.lineWidth=1;for(var B=0;B<=2000;B=B+wanggewidthh){if(B/5%5==0){C.beginPath();C.moveTo(18+B,18);C.lineTo(18+B,5);C.closePath();C.stroke();C.fillStyle="blue";C.textBaseline="top";C.fillText(B,B+10,0)}else{C.beginPath();C.moveTo(18+B,18);C.lineTo(18+B,10);C.closePath();C.stroke()}}var A=document.getElementById("rulervc");var E=A.getContext("2d");E.beginPath();E.clearRect(0,0,A.width,A.height);E.lineWidth=1;for(var B=0;B<=1500;B=B+wanggewidthv){if(B/5%5==0){E.beginPath();E.moveTo(5,B);E.lineTo(18,B);E.closePath();E.stroke();E.fillStyle="blue";E.textBaseline="top";E.fillText(B,0,B-4)}else{E.beginPath();E.moveTo(10,B);E.lineTo(18,B);E.closePath();E.stroke()}}}huizhibilichi();function jixian(){lineh.setAttribute("x1",0);lineh.setAttribute("y1",0);lineh.setAttribute("x2",0);lineh.setAttribute("y2",1500);lineh.setAttribute("stroke","yellow");lineh.setAttribute("stroke-width",1);lineh.setAttribute("fill","none");svg.appendChild(lineh);linev.setAttribute("x1",0);linev.setAttribute("y1",0);linev.setAttribute("x2",2000);linev.setAttribute("y2",0);linev.setAttribute("stroke","yellow");linev.setAttribute("stroke-width",1);linev.setAttribute("fill","none");svg.appendChild(linev)}jixian();gggg.setAttribute("shizi","shizi");svg.appendChild(gggg);